
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Crash Course DevOps - Hack hack hack...</title>
  <meta name="author" content="Adam Jonas">

  
  <meta name="description" content="Wires, cables and WiFi Bits sent as light beams, no signal loss faster than copper WiFi is radio and then translated into physical bits over the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="bPr3kB-X2beP1o9InhOKH9ci-gljU3a7NLEeap4urfc" />

  
  <link rel="canonical" href="http://adamjonas.com/blog/crash-course/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hack hack hack..." type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
 <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35486864-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">Adam Jonas</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Hack hack hack...</a></h1>
  
    <h2>An open journal-- some of it written for you, but most of it is for me.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamjonas.com" />
    <input class="search" type="text" name="q" results="100" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/glossary">Glossary</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Crash Course DevOps</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2017-03-20T11:12:00-04:00" pubdate data-updated="true">Mar 20<span>th</span>, 2017</time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Wires, cables and WiFi</h2>

<ul>
<li>Bits sent as light beams, no signal loss

<ul>
<li>faster than copper</li>
</ul>
</li>
<li>WiFi is radio and then translated into physical bits over the wires</li>
<li>Bitrate -> bits per second -> how fast it can transmit</li>
<li>bandwidth -> how much data can you receive over a period of time</li>
<li><p>latency -> how long it takes, more hops to talk to Seiji than
Kaitlin in the next room; ping time * distance</p></li>
<li><p><code>traceroute</code> to see hops</p></li>
</ul>


<h2>IP addresses and DNS</h2>

<ul>
<li>ISP</li>
<li>IP is a unique address

<ul>
<li>IPv4 - 4 billion unique addresses isn&#8217;t enough

<ul>
<li>32 bits, 8 octets</li>
<li>32 bits long, 8 bits for each part of each address</li>
<li>DHCP -> obtaining a lease renewal process on your network.</li>
<li>to the outside world, Flatiron has the same IP provided
by ISP</li>
<li>router provides guests with temporary IP depending on how long
your lease renewal is set</li>
<li>renegotiate IP
?- subnet mask</li>
<li>255.255.255.255 is the max it could go, based on the octet</li>
<li>static IP -> unique in the world</li>
<li>private IP -> re-use private IP addresses behind networks</li>
</ul>
</li>
</ul>
</li>
<li><p> IPv6 - 128 bits instead of 32</p>

<ul>
<li>hex representation to prevent us running out of static IPs</li>
<li><p>DNS servers are split up in TLDs</p>

<ul>
<li>DNS on a router</li>
</ul>
</li>
<li><p>google&#8217;s DNS will break it up by the TLD and domain</p></li>
<li><a href="http://www.macworld.com/article/2824564/slow-internet-edit-your-dns-settings.html">google DNS</a> versus open DNS</li>
<li>?www doesn&#8217;t mean anything any more, just another subdomain</li>
<li>?CS of how the domain names at the DNS are stored?</li>
</ul>
</li>
<li><p> TTL</p>

<ul>
<li>this record will expire at X time</li>
<li>set TTL to an hour, it won&#8217;t have to look it up for an hour</li>
<li>DNS propagation</li>
</ul>
</li>
<li><p>DNS -> record type</p>

<ul>
<li>A record -> address</li>
<li>maps the word name the domain to a physical IP address</li>
<li>PTR -> pointer -> the reverse, input IP and get the domain</li>
<li>FQDN -> A fully qualified domain name (<a href="http://stackoverflow.com/questions/19480767/domain-names-with-dots-at-the-end">FQDN</a>) is the complete domain name for a specific computer, or host, on the Internet.

<ul>
<li>Host name is gmail and .com is the TLD</li>
</ul>
</li>
<li>CNAME -> mail.google.com is a CNAME of googlemail.l.google.com.

<ul>
<li>A records should be unique</li>
</ul>
</li>
<li>why is there a dot at the end?

<ul>
<li>it is an absolute as opposed to the relative address</li>
</ul>
</li>
<li>want multiple MX records, redudency strategy</li>
</ul>
</li>
</ul>


<h2>Packet, routers and reliability</h2>

<ul>
<li>fault tolerant</li>
<li>TCP</li>
<li><p>?How do they determine the route?</p>

<ul>
<li>routers own the ISP and the companies that own them</li>
</ul>
</li>
<li><p>traceroute domain.com</p></li>
<li><p>wireshark is a GUI of <a href="https://danielmiessler.com/study/tcpdump/#gs.9p=ZVMQ"><code>tcpdump</code></a></p></li>
<li><p>IP address can change and it has a serial number or a MAC address
(hardware address)</p></li>
</ul>


<h2>HTTP &amp; HTML</h2>

<ul>
<li>SSL and TLS (successor)

<ul>
<li>http listens on 80 and https listens on 443</li>
<li>sslv3 has been deprecated</li>
</ul>
</li>
<li>certificate authority vouches for site</li>
<li>OpenSSL generates keys, authority will sign that</li>
<li>self-signed certs like for nagios or letsencrypt will work fine</li>
<li>SSLS

<ul>
<li>discrete logorithm problem</li>
</ul>
</li>
<li>handshake process -> how to keep box locked and send secret

<ul>
<li>put treasure in box, lock box, send to friend</li>
<li>friend puts lock on box, sends it back</li>
<li>I remove lock from box and send back</li>
<li>friend unlocks box</li>
</ul>
</li>
<li>SSH

<ul>
<li>ssh forwarding sends private key along</li>
<li>asymetric only used for authentication</li>
<li>symetric is then used for encryption and decryption</li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Bcrypt">bcrypt</a> is what we use for email</li>
</ul>


<h2>DDoS</h2>

<ul>
<li><a href="https://en.wikipedia.org/wiki/Domain_Name_System#DNS_resolvers">DNS resolvers</a> to amplify attack</li>
</ul>


<h2>DevinOps in review</h2>

<ul>
<li><a href="https://github.com/thiagopradi/octopus">Octopus gem</a> -> pooling, load balance select statements to read only
replicas</li>
<li>DB sharding

<ul>
<li>complex SQL joins, will put different tables in different DBs</li>
<li>replication</li>
</ul>
</li>
<li>floating IPs points to the master

<ul>
<li>static IP never changes</li>
<li>use floating IPs rather than DNS because of propogation</li>
</ul>
</li>
<li>usernames:

<ul>
<li>if you have a server on linux it should not be running on root</li>
<li>if it&#8217;s a system process then it would be ok to run on root</li>
<li>postgres is run as the postgres user

<ul>
<li>apache is run by deployer and passenger -> how ruby achieves
paralellization (a module for apache)</li>
</ul>
</li>
<li>deployer for Ironboard -> easy way to manage keys</li>
<li>how owns the process, who owns the directory where the config
files lives</li>
</ul>
</li>
<li><code>etc/passwd</code> -> all the users on the box and who is logged in</li>
<li>every service that has a port open to the internet it should have
its own user</li>
<li>username is usually the service name</li>
<li><code>/var</code> is usually the log directory</li>
<li><code>/etc</code> is usually the config directory</li>
<li>WAL-E

<ul>
<li>ship our binary logs we sent to s3</li>
<li><a href="https://en.wikipedia.org/wiki/Write-ahead_logging">write ahead logs</a> -> must be complete before actually modifies the
DB with a transaction. This is the mechanism for rollbacks.

<ul>
<li>master just sends the write-ahead logs to the slave which then
just replays them</li>
</ul>
</li>
</ul>
</li>
<li>Backups

<ul>
<li>take a base and then the have these WAL backups and send them off
and it will apply all the deltas</li>
<li>can give us point in time restoration</li>
<li>these logs will fill up our disk</li>
<li>? how long do we keep WAL-E</li>
<li>interface for deleting backups, s3 logs</li>
<li>config of pg is <code>pg_hba.conf</code></li>
<li>script to switch over primary/replication script turns <code>recovery.conf</code> to <code>recovery.done</code></li>
<li><code>failover.sh</code> on the other replica as root

<ul>
<li>breaks replication, now need to configure replication on the new
replication server</li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Iptables">iptables</a> -> firewall</li>
</ul>
</li>
</ul>


<h2>Permissions</h2>

<ul>
<li>User, Group, World -> multiple users on the same machine, make sure
processes don&#8217;t do stuff they aren&#8217;t supposed to</li>
<li>chmod 755, 644</li>
<li>all directories have to be 7

<ul>
<li>directories point to other files</li>
</ul>
</li>
<li>cd is a program that takes a directory (file) as an argument and
executes it</li>
<li><code>etc/sudoers</code> -> determines who has root permissions; visudo -> creates a backup and prevents brackage</li>
<li><code>useradd</code> give them a shell and name the user; want to add to the
chef script</li>
</ul>


<h2>load balancer</h2>

<ul>
<li>front-end is learn.co, terminating SSL, in the</li>
<li>backend -></li>
<li>should be root on</li>
</ul>


<h2>Debugging</h2>

<ul>
<li><code>passenger-status --show=requests</code></li>
<li><code>passenger-status</code></li>
</ul>


<h2>Automatic provisioning</h2>

<ul>
<li><a href="https://github.com/digitalocean/doctl">doctl</a></li>
<li><a href="https://github.com/petems/tugboat">tugboat</a></li>
</ul>


<h2>cron</h2>

<ul>
<li>sends mail</li>
</ul>


<h2>IDE backend</h2>

<ul>
<li>backend application -> IDE umbrella</li>
<li>main one is learn-ide-server cookbook</li>
<li>different chef servers</li>
<li>wombat</li>
<li>traffic cop</li>
<li>elixir-build01 -> build elixir on server because linux</li>
<li>new server needs to be added to <a href="https://github.com/flatiron-labs/students-chef-repo/tree/master/cookbooks/learn-ide-haproxy">HAproxy</a></li>
<li>lb -> <code>balance url_param token</code> hashing algorithm that determines
which server the IDE connects to based on their Learn oauth token. (Optimization -> make hashing algo
more granualar so that if a machine gets taken out the rotation, the
othere aren&#8217;t rebalanced as well</li>
<li>Load balance assignment is determined by dynect traffic management

<ul>
<li>own health monitoring</li>
</ul>
</li>
<li><a href="https://www.gluster.org/">gluster</a> is fancy NFS

<ul>
<li>RAID -> redundant array of independent disks</li>
</ul>
</li>
<li><a href="https://coreos.com/rkt/">rkt</a></li>
<li>PTY - psuedoterminal, terminal emulator, connect to an arbitrary shell</li>
<li>inotify -> FS event watcher</li>
<li>containerization

<ul>
<li><a href="https://en.wikipedia.org/wiki/Aufs">aufs</a> loser -> <a href="https://en.wikipedia.org/wiki/UnionFS">unionfs</a> winner that was merged into linux</li>
</ul>
</li>
<li>? do you bump archived tar&#8217;ed files when you archive again</li>
</ul>


<h2>IDE Umbrella</h2>

<ul>
<li>for adding IDE server (<a href="https://github.com/flatiron-labs/ide_umbrella/blob/master/config/prod.exs">node list</a>)</li>
<li>dependencies in <code>mix.exs</code>; <a href="https://github.com/ninenines/cowboy">cowboy</a> is the webserver, <a href="https://github.com/devinus/poolboy">poolboy</a></li>
<li>applications are like slightly fancy supervisors, <a href="https://github.com/bitwalker/distillery">distillery</a> release packaging</li>
<li><code>mix deps.get</code> -> get dependencies</li>
<li><code>iex -S mix</code></li>
<li><code>:cowboy.start</code> -> erlang library, cowboy is lib which is an atom</li>
<li><code>gen_server</code>, an abstraction on top of processes in general

<ul>
<li>provides state and a little behavior</li>
</ul>
</li>
<li><code>agent</code> is just for state</li>
<li>every connection gets its own process</li>
<li>distillery builds them

<ul>
<li>release -> full replacement of previous release, must restart</li>
<li>upgrade -> release plus upgrade instructions, relup file, modify
the code in memory -> hotswap; preferable to release</li>
<li><code>mix edeliver version qa</code></li>
<li><code>mix edeliver version production</code></li>
<li><code>mix edeliver build release</code></li>
<li><code>mix edeliver deployer release to qa</code></li>
<li><code>mix edeliver restart qa</code></li>
<li><code>bin/ide start</code></li>
<li><code>bin/ide attach</code> -> quit with ^D, not ^c (will kill process)</li>
<li><code>bin/ide remote_console</code></li>
<li><code>mix edeliver build upgrade --with=0.1.0+232424323-hdhfd</code></li>
<li><code>mix edeliver deploy upgrade to qa</code> -> will prompt for version
number</li>
</ul>
</li>
</ul>


<h2>Chef</h2>

<ul>
<li>server provisioning

<ul>
<li>consistency, automation</li>
</ul>
</li>
<li>inheritance in the cookbooks, base cookbook -> security</li>
<li>like ruby base cookbooks</li>
<li><a href="https://blog.chef.io/2013/12/03/doing-wrapper-cookbooks-right/">wrapper cookbook</a>, like forking a cookbook without modifying it

<ul>
<li>increasing levels of abstraction</li>
</ul>
</li>
<li>conventions of chef aren&#8217;t very clearly defined</li>
<li>differences between recipes and cookbooks?</li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Adam Jonas</span></span>

      








  


<time datetime="2017-03-20T11:12:00-04:00" pubdate data-updated="true">Mar 20<span>th</span>, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/devops/'>DevOps</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/elastic-search/" title="Previous Post: Elastic Search">&laquo; Elastic Search</a>
      
      
        <a class="basic-alignment right articlenav" href="/blog/project-aristole/" title="Next Post: Project Aristole">Project Aristole &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/project-aristole/">Project Aristole</a>
      </li>
    
      <li class="post">
        <a href="/blog/crash-course/">Crash Course DevOps</a>
      </li>
    
      <li class="post">
        <a href="/blog/elastic-search/">Elastic Search</a>
      </li>
    
      <li class="post">
        <a href="/blog/preparing-data-for-machine-learning/">Preparing Data for Machine Learning</a>
      </li>
    
      <li class="post">
        <a href="/blog/the-soul-in-the-machine-developing-for-humans/">The Soul in The Machine - Developing for Humans</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Adam Jonas -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'ajonas';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://adamjonas.com/blog/crash-course/';
        var disqus_url = 'http://adamjonas.com/blog/crash-course/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
